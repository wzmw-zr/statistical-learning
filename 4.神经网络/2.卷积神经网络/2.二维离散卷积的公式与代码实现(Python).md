# 二维离散卷积的公式与代码实现

## 一、二维离散卷积公式

$$
conv2d = \sum_{i=0}^k\sum_{j=0}^kf(i,j)h(k-i,k-j)
$$

> 深度学习中conv2d卷积层无所谓是否翻转的，因为所有的weights也就是kernel其实是随机初始化的。那么每次的更新迭代都是为了去寻找一个最合适的kernel，所以是否翻转也变的无关紧要了。



##  二、CNN中的convolution layer

CNN中的卷积操作与而为卷积计算略有不同。图片是一个$(width,height,channels)$的一个三维矩阵$(batchsize = 1)$，使用的是三维离散卷积，公式如下：
$$
a_{i,j}=\sum_{d = 0}^{D-1}\sum_{m = 0}^{K - 1}\sum_{n=0}^{K-1}w_{d,m,n}x_{d,i+m,j+n}
$$
convolution kernel的channels数量与`input_channels`相同，一个convolution kernel对所有图片(或feature map)的计算结果是2-d array，因此需要多个convolution kernel，convolution kernel的数量就是`output_channels`的数值。